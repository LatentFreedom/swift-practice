//
//  main.swift
//  CribDragging
//
//  Created by Nick Palumbo on 3/31/16.
//  Copyright Â© 2016 Nick Palumbo. All rights reserved.
//

import Foundation

let mostCommonWords :[String] = ["the" , "be", "to", "of"]

////////////////////////////////////////////////////////////////////
/////////////// INPUTS /////////////////////////////////////////////
////////////////////////////////////////////////////////////////////

let cribAsciiString = "the"
let s = 1008 // startBit
let e = 1048 // endBit

let xorBinaryString = "000000000000000000000000000000000001010100001010000110010000000100011101000111010001011000010111000000000110011001011110010100100001111100010110010000000100010100000000000001100001101101010000000100000101110000000000000010100000000000010111000101110100110000101100000111000000110000010000010010000000010000000110010011110010100001101001001111010100111001010101001000100000010100001011000100010100000100000111000000000000110001010010000000010100100100011011000010110100001101000101010100010101111101011111000011000100111100000100010001010011010000001000000000010000100101001001001101010000010101001111001000010101110101001111001001010101010100010010010110010101001100000001000011110100000100000010010011010101001000000001000111010000000000010110010100110000100101001001000100110100111100011010000010110001110100000110010000010001101100011101000001110000101101010010000111000100100000000000001101010100100000010110010000010001100100001011000001010000001000010000010010000100000100011010000011100000110000001010010101000000100000011000010011000001010100011100000010100101001001001101000001010000101100000001000000110000001000010111000110110000011101010010000001000100110000000000000010000100011101010000000001010000000000011010000111000101001101000001010011110010010101001000000001000101001000001101000001110000110000000111010101100101001100010111000011100001101100001010000101010001011100010110000011000101010000001110010011100000100101000101000001000000101100011100000000010001000101000101000100000100100000010001010011110100000101000011010010100101110001000010010011110100110001110100000011000000011000011111000101100000110000011010010010010000011000000000000111010100111100010111000011110001000001000101000000010100111000001100000111000100011100011101000000000001000001001000000000010000100101001100000001110000111000011110010100100000110100001101000010110100010100000110000010000001011001001011010001110000111000011000000110010100000101000001000111000100000100111100000111010100100101001100001110100001101000000110010000110001010101000001000000000000110100001011010101000101010000000011000000110001011101010011000101110000011100010101010001010111010000010110000111010001111000001001000111010000000000011100000010100001000000000000000100100001011101001111000000100000110000011110000101100100010001000011010001100101010000101100000001000100111000011010000101010000110101000011001011100000110000010111"

let inputHex1 = "60 83 20 32 C6 93 2A 4F B3 54 1B 11 9E 8F F2 12 9E 95 0F 50 64 F2 76 57 31 59 6D C0 83 72 93 7F B3 02 84 94 AA 4B C3 B2 72 57 B0 41 10 0E 5E FE C3 34 79 1D AF 31 B1 2A 18 AB A4 B4 C1 A3 7F 57 5C B9 31 21 27 51 CA 00 03 C0 7E 2E 5A 33 3A 74 CB 1F 50 EF AF 20 F3 78 DA 4F 12 52 33 F9 58 59 EE D3 AA 1A 68 08 0E 0F 8F A2 66 AD EA F3 3D E7 BB AE C7 E7 53 C9 ED 17 0B 5E A2 2D EF C1 11 6A 54 12 67 89 FA 91 D9 CE 7E BA 8E CF EF EC D9 EE 9A 58 26 A1 30 23 65 02 E9 13 76 E8 32 77 FA 4B 1B B5 16 63 65 B7 E0 C9 98 65 BD E4 76 CE F4 EE C8 A1 73 8F E0 AC 6B CD EB 36 37 51 7F 7A BA E7 F2 BF 96 63 98 46 F1 0B F5 A3 00 06 B3 E7 C1 65 40 1B F1 F9 DC 28 F6 43 5D 3C 89 66 65 F1 00 10 2D 87 35 BE 9D 72 8D 5A CF E9 8E 6D F6 BD 1E 3A 29 6D 04 08 75 E3 04 8A 66 E2 65 DD B7 03 1D 29 24 F6 98 18 59 B7 79 CD 94 B2 6A 54 CF 50 BF 20 58 7F 89 48 04 35 72 89 39 AB 40 7B 78 02 15 A5 08 51 2D 95 D9 D4 D2 6A B5 02 DE 58 "

let inputHex2 = "60 83 20 32 D3 99 33 4E AE 49 0D 06 9E E9 AC 40 81 83 4F 15 64 F4 6D 07 21 05 6D CA 83 65 84 33 9F 1E 88 84 E2 4F C5 FD 5A 3E 8D 0F 45 2C 5B F5 D2 75 7E 1D A3 63 B0 63 03 A0 E7 F1 90 FC 20 5B 13 BD 74 15 2F 50 C3 49 36 C5 31 0F 07 7C 1F 21 D9 46 03 EE A0 61 F1 35 88 4E 0F 52 25 AA 51 10 FD 9C B0 11 75 0E 4F 14 92 A5 6D FF F6 BB 3D D2 F3 B8 86 FE 58 CC EF 07 43 1F B8 23 E3 CB 45 62 4C 5E 72 95 F0 C3 94 CB 75 BB 8D CD F8 F7 DE BC 9E 14 26 A9 77 73 60 02 F3 0F 25 A9 7D 52 B2 4F 49 B8 11 6F 62 E1 B3 DE 96 7E B7 F1 61 D8 F8 BA C6 EF 7A CA E4 A7 77 CC FA 73 27 19 6E 35 FB A4 B8 E3 D4 2C D4 32 FD 0D EA B5 0C 1C FA E1 C1 78 0F 0C FE E9 99 29 B8 4F 41 7B 94 66 75 B9 01 19 61 80 3B A0 CF 7F 80 51 8A EF 86 7B BD FA 10 22 30 2C 45 14 34 DF 19 C3 2A D8 7F DB F4 16 5C 29 29 FD CC 4C 5A B4 6E 9E 83 B5 7F 11 BB 46 A2 3E 51 62 89 54 0E 25 72 9B 2E E4 42 77 66 14 51 E6 4E 05 01 91 97 CE C7 67 F6 2C D2 4F "

////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////

func main() {
    
    // create array of characters for crib string
    let cribBinaryArray : [String] = CreateCribBinaryArrayOfCharacters(cribAsciiString)
    
    // create array of characters for XOR string
    let xorArrayOfCharacters : [String] = CreateXorBinaryArrayOfCharacters(xorBinaryString, cribBinaryLength: cribBinaryArray.count)

    // drag crib through xor array
    cribDragx2nBits(xorArrayOfCharacters, cribBinaryCharacterArray: cribBinaryArray)
    print("Found \(stringCounter) strings.")
    
    dragFromBitToBit(cribBinaryArray, xorBinaryArray: xorArrayOfCharacters, startBit: s, endBit: e + cribBinaryArray.count)
}

func dragFromBitToBit(cribBinaryArray : [String], xorBinaryArray : [String], startBit : Int, endBit : Int) {
    
    
    let cribLength : Int = cribBinaryArray.count
    
    var xorToBeDragged : [String] = Array()
    var hexResult : String = String()
    var hexResultArray : [String] = Array()
    var asciiResult : String = String()
        
    // create single character array of xor binary part to be xored with crib binary
    for n in startBit..<startBit+cribLength {
        xorToBeDragged.append(xorBinaryArray[n])
    }
        
    let result : String = XorTwoBinaryArraysOfCharacters(xorToBeDragged, binaryArray2: cribBinaryArray, length: cribLength)
    
    let resultArray4LengthBinaryStrings : [String] = StringToArrayOfNStrings(result, length: 4)
    for s in resultArray4LengthBinaryStrings {
        hexResult += BinaryToHex(String(s))
    }
    
    hexResultArray = StringToArrayOfNStrings(hexResult, length: 2)
    
    for s in hexResultArray {
        asciiResult += HexToAscii(s)
    }
    
    if !(asciiResult.containsString("_")) {
        stringCounter += 1
        print(asciiResult)
    }
    else {
        print(asciiResult)
    }
}

main()

//ReplaceBinarySectionWithStringOfAscii(xorBinaryString, asciiString: cribAsciiString, startBit: 2104, endBit: 2144)